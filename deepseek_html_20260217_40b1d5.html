<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Telegram Mini App Test</title>
    
    <!-- Telegram SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }
        
        /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
        body.light-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ Telegram */
        body.dark-theme {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .card {
            background: var(--tg-theme-bg-color, rgba(255, 255, 255, 0.95));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        body.dark-theme .card {
            background: rgba(30, 30, 46, 0.95);
            color: #fff;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }
        
        h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--tg-theme-hint-color, #666);
            text-align: center;
        }
        
        .info-grid {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }
        
        .info-item {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            border-left: 4px solid #667eea;
        }
        
        body.dark-theme .info-item {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .info-icon {
            font-size: 24px;
            margin-right: 15px;
            min-width: 40px;
            text-align: center;
        }
        
        .info-content {
            flex: 1;
        }
        
        .info-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 16px;
            font-weight: 600;
            word-break: break-word;
        }
        
        .badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            margin: 5px;
        }
        
        .badge-telegram {
            background: #0088cc;
            color: white;
        }
        
        .badge-web {
            background: #ff6b6b;
            color: white;
        }
        
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .button:active {
            transform: translateY(0);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
        }
        
        .status-badge {
            background: #10b981;
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 14px;
            display: inline-block;
            margin-top: 15px;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            color: var(--tg-theme-hint-color, #999);
            font-size: 12px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .loading {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="card" style="text-align: center;">
            <h1>ü§ñ Telegram Mini App</h1>
            <h2>–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h2>
            <div id="platform-badge"></div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
        <div class="card">
            <h2 style="text-align: left; margin-bottom: 15px;">üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h2>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-icon">üÜî</span>
                    <div class="info-content">
                        <div class="info-label">Telegram ID</div>
                        <div class="info-value" id="user-id">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <span class="info-icon">üë§</span>
                    <div class="info-content">
                        <div class="info-label">–ò–º—è</div>
                        <div class="info-value" id="first-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <span class="info-icon">üìù</span>
                    <div class="info-content">
                        <div class="info-label">–§–∞–º–∏–ª–∏—è</div>
                        <div class="info-value" id="last-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <span class="info-icon">üìß</span>
                    <div class="info-content">
                        <div class="info-label">Username</div>
                        <div class="info-value" id="username">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                </div>
                
                <div class="info-item">
                    <span class="info-icon">üåê</span>
                    <div class="info-content">
                        <div class="info-label">–Ø–∑—ã–∫</div>
                        <div class="info-value" id="language">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                </div>
            </div>
            
            <div id="status" style="text-align: center;"></div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ -->
        <div class="card">
            <h2 style="text-align: left; margin-bottom: 15px;">üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h2>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="viewport-height">-</div>
                    <div class="stat-label">–í—ã—Å–æ—Ç–∞</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="viewport-width">-</div>
                    <div class="stat-label">–®–∏—Ä–∏–Ω–∞</div>
                </div>
            </div>
            
            <div class="info-item">
                <span class="info-icon">üé®</span>
                <div class="info-content">
                    <div class="info-label">–¢–µ–º–∞</div>
                    <div class="info-value" id="theme">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
            
            <div class="info-item">
                <span class="info-icon">üì¶</span>
                <div class="info-content">
                    <div class="info-label">–í–µ—Ä—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</div>
                    <div class="info-value" id="platform-version">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="card">
            <button class="button" onclick="sendTestData()">
                üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            </button>
            
            <button class="button" onclick="showTelegramAlert()">
                üîî –ü–æ–∫–∞–∑–∞—Ç—å Alert
            </button>
            
            <button class="button" onclick="showTelegramConfirm()">
                ‚ùì –ü–æ–∫–∞–∑–∞—Ç—å Confirm
            </button>
            
            <button class="button" onclick="copyUserData()">
                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
            </button>
            
            <button class="button" onclick="expandApp()">
                ‚ÜîÔ∏è –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
            </button>
            
            <button class="button" onclick="closeApp()">
                ‚ùå –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            </button>
        </div>
        
        <!-- –î–∞–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ -->
        <div class="card">
            <h2 style="text-align: left; margin-bottom: 15px;">üîß –î–∞–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏</h2>
            <div class="info-item">
                <div class="info-content">
                    <div class="info-label">initData</div>
                    <div class="info-value" id="init-data" style="font-size: 10px;">-</div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            üß™ Telegram Mini App Test Page | Flask + Telegram
        </div>
    </div>
    
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è Telegram
        let tg = null;
        let userData = {};
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram
            if (window.Telegram && Telegram.WebApp) {
                tg = Telegram.WebApp;
                tg.expand();
                tg.ready();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
                document.getElementById('platform-badge').innerHTML = 
                    '<span class="badge badge-telegram">‚úÖ –ó–∞–ø—É—â–µ–Ω–æ –≤ Telegram</span>';
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É
                const theme = tg.colorScheme;
                document.body.classList.add(theme === 'dark' ? 'dark-theme' : 'light-theme');
                document.getElementById('theme').textContent = theme === 'dark' ? 'üåô –¢–µ–º–Ω–∞—è' : '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è';
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = tg.initDataUnsafe?.user;
                if (user) {
                    userData = user;
                    
                    document.getElementById('user-id').textContent = user.id || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    document.getElementById('first-name').textContent = user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    document.getElementById('last-name').textContent = user.last_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    document.getElementById('username').textContent = user.username ? '@' + user.username : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    document.getElementById('language').textContent = user.language_code || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                } else {
                    setDemoData();
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º initData
                if (tg.initData) {
                    document.getElementById('init-data').textContent = tg.initData.substring(0, 50) + '...';
                }
                
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
                document.getElementById('platform-version').textContent = tg.version || '1.0';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã
                updateViewport();
                
                console.log('‚úÖ Telegram Mini App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                // –î–µ–º–æ-—Ä–µ–∂–∏–º
                document.getElementById('platform-badge').innerHTML = 
                    '<span class="badge badge-web">‚ö†Ô∏è –î–µ–º–æ-—Ä–µ–∂–∏–º (–Ω–µ –≤ Telegram)</span>';
                
                setDemoData();
                document.body.classList.add('light-theme');
                document.getElementById('theme').textContent = '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è (–¥–µ–º–æ)';
                document.getElementById('platform-version').textContent = '–î–µ–º–æ';
                updateViewport();
                
                console.log('‚ö†Ô∏è –î–µ–º–æ-—Ä–µ–∂–∏–º');
            }
        });
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
        function setDemoData() {
            document.getElementById('user-id').textContent = '123456789';
            document.getElementById('first-name').textContent = '–¢–µ—Å—Ç–æ–≤—ã–π';
            document.getElementById('last-name').textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            document.getElementById('username').textContent = '@test_user';
            document.getElementById('language').textContent = 'ru';
            document.getElementById('init-data').textContent = '–î–µ–º–æ-—Ä–µ–∂–∏–º';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
        function updateViewport() {
            document.getElementById('viewport-height').textContent = window.innerHeight + 'px';
            document.getElementById('viewport-width').textContent = window.innerWidth + 'px';
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function sendTestData() {
            if (tg) {
                const data = {
                    action: 'test_action',
                    user_id: userData.id,
                    timestamp: new Date().toISOString(),
                    data: '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ'
                };
                
                tg.sendData(JSON.stringify(data));
                showStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram!');
            } else {
                showStatus('‚ö†Ô∏è –î–µ–º–æ-—Ä–µ–∂–∏–º: –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å Alert
        function showTelegramAlert() {
            if (tg) {
                tg.showAlert('üß™ –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–ª–µ—Ä—Ç –æ—Ç Telegram Mini App!');
            } else {
                alert('–î–µ–º–æ-—Ä–µ–∂–∏–º: ' + 'üß™ –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–ª–µ—Ä—Ç –æ—Ç Telegram Mini App!');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å Confirm
        function showTelegramConfirm() {
            if (tg) {
                tg.showConfirm('–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?', function(confirmed) {
                    if (confirmed) {
                        showStatus('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª');
                    } else {
                        showStatus('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª');
                    }
                });
            } else {
                const confirmed = confirm('–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?');
                showStatus(confirmed ? '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ (–¥–µ–º–æ)' : '‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ (–¥–µ–º–æ)');
            }
        }
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function copyUserData() {
            const data = JSON.stringify({
                user: userData,
                platform: tg ? 'telegram' : 'web',
                timestamp: new Date().toISOString()
            }, null, 2);
            
            navigator.clipboard.writeText(data).then(function() {
                showStatus('üìã –î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä');
            });
        }
        
        // –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        function expandApp() {
            if (tg) {
                tg.expand();
                updateViewport();
                showStatus('‚ÜîÔ∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ');
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function closeApp() {
            if (tg) {
                tg.close();
            } else {
                showStatus('‚ùå –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
        function showStatus(message) {
            const statusEl = document.getElementById('status');
            if (statusEl) {
                statusEl.innerHTML = `<span class="status-badge">${message}</span>`;
                setTimeout(() => {
                    statusEl.innerHTML = '';
                }, 2000);
            }
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–∫–Ω–∞
        window.addEventListener('resize', updateViewport);
    </script>
</body>
</html>